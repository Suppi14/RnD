\chapter{Popov-Vereshchagin hybrid dynamics solver}
A hybrid dynamics algorithm solves the combined forward/inverse dynamics
problem [Featherstone, 2008]: given some actual and desired joint motions and forces, some actual and desired segment motions and forces, as well as the mass distribution of each segment, find the resulting motion of the complete kinematic chain. Hybrid dynamics is the major algorithm for the posture control[Khatib et al., 1999] of mobile manipulators and humanoid robots, since such tasks typically require specifications of motion and/or force constraints on the end-effectors and other segments, but also specifications on the posture that keeps the robot close to a “most comfortable” configuration (for itself, its task, or its environment) via additional internal joint motions, forces or constraints, or (possibly virtual) external forces or constraints on intermediate segments.